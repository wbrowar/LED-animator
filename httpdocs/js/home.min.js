function getUrlVars(){for(var a,b=[],c=window.location.href.slice(window.location.href.indexOf("?")+1).split("&"),d=0;d<c.length;d++)a=c[d].split("="),b.push(a[0]),b[a[0]]=a[1];return b}function rgb2hex(a){return a=a.match(/^rgba?[\s+]?\([\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?/i),a&&4===a.length?"#"+("0"+parseInt(a[1],10).toString(16)).slice(-2)+("0"+parseInt(a[2],10).toString(16)).slice(-2)+("0"+parseInt(a[3],10).toString(16)).slice(-2):""}function hexToRgb(a){var b=/^#?([a-f\d])([a-f\d])([a-f\d])$/i;a=a.replace(b,function(a,b,c,d){return b+b+c+c+d+d});var c=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(a);return c?{r:parseInt(c[1],16),g:parseInt(c[2],16),b:parseInt(c[3],16)}:null}function updateUrl(){if(setupComplete){var a,b,c,d=jq('input[name="rows"]').val(),e=jq('input[name="cols"]').val(),f="";jq("#grid .display .pixel").each(function(a){b=rgb2hex(jq(this).css("background-color")).replace("#",""),c=0===a?"":",",f+=c+b}),a="?rows="+d+"&cols="+e+"&colors="+f,jq("#return_wrapper").addClass("active"),jq("#return_url").text(document.location.href.split("?")[0]+a),window.history.pushState({},"Data Saved",a)}}function updateGrid(a,b){var c,d=jq("#grid .display"),e=0;for(jq(d).empty(),c=0;a>c;c++)jq(d).append('<div class="row"></div>');jq(d).find(".row").each(function(){for(c=0;b>c;c++)jq(this).append('<div class="pixel" data-id="'+e+'"><div class="spacer"></div></div>'),e++});var f=3;if(b>30?f=1:b>8&&(f=2),jq("body").removeClass("pixel_size_1").removeClass("pixel_size_2").removeClass("pixel_size_3").addClass("pixel_size_"+f),void 0!==getUrlVars().colors){var g=getUrlVars().colors.split(",");for(c=0;c<g.length;c++)jq(".pixel[data-id="+c+"]").css("background-color","#"+g[c])}setupPixels(),updateUrl()}function setupPixels(){jq(".pixel").unbind("click").click(function(){pixelSelected||(currentPixelId=jq(this).attr("data-id"),jq("#color_picker").addClass("active"),jq(this).addClass("active"),jq("#color_picker_input").val(rgb2hex(jq(this).css("background-color"))),pixelSelected=!0)})}var jq=jQuery,setupComplete=!1,pixelSelected=!1,currentPixelId,lastPixelColor="rgb(0, 0, 0)";jq("#settings_form").submit(function(a){a.preventDefault();var b=1,c=1;""!==jq(this).find('input[name="rows"]').val()&&(b=parseFloat(jq(this).find('input[name="rows"]').val())),""!==jq(this).find('input[name="cols"]').val()&&(c=parseFloat(jq(this).find('input[name="cols"]').val())),updateGrid(b,c)}),jq("#color_picker_done").click(function(){jq("#color_picker").removeClass("active"),jq(".pixel").removeClass("active"),jq("#color_last_pixel_wrapper").addClass("active"),jq("#color_last_pixel").css("background-color",jq(".pixel[data-id="+currentPixelId+"]").css("background-color")),jq("#color_last_pixel").click(function(){jq(".pixel[data-id="+currentPixelId+"]").css("background-color",jq(this).css("background-color"))}),lastPixelColor=jq(".pixel[data-id="+currentPixelId+"]").css("background-color"),updateUrl(),pixelSelected=!1}),jq("#color_picker_input").change(function(){jq(".pixel[data-id="+currentPixelId+"]").css("background-color",jq(this).val())}),jq("#generate").click(function(){var a,b;jq("#generate_code").val(""),jq("#grid .display .pixel").each(function(c){a=rgb2hex(jq(this).css("background-color")).replace("#","0x"),b=0===c?"":"\n",jq("#generate_code").val(jq("#generate_code").val()+b+"strip.setPixelColor("+c+", "+a+");")})}),jq(document).ready(function(){var a=1,b=9,c=Math.floor(Math.random()*(b-a+1))+a;jq("body").removeClass("site_theme_1").addClass("site_theme_"+c);var d=void 0!==getUrlVars().rows?getUrlVars().rows:1,e=void 0!==getUrlVars().cols?getUrlVars().cols:1;jq(this).find('input[name="rows"]').val(d),jq(this).find('input[name="cols"]').val(e),updateGrid(d,e),jq("body").keyup(function(a){if(190==a.keyCode){var b=document.querySelectorAll(":hover"),c=b[b.length-2];jq(c).css("background-color",lastPixelColor),updateUrl()}}),setupComplete=!0});